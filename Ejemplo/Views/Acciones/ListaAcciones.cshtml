@model IEnumerable<Ejemplo.Models.Ca_AccionesProcesales>
@{
    ViewBag.Title = "ListaAcciones";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="centro">
<table id="tableOne" class="yui" width="100%" style="margin: 1% auto;" >
        <thead>
        <tr>
            <td class="tableHeader" colspan="4">
                    <a href="/Acciones/NuevaAccionProcesal">Nueva Accion Procesal</a>
                            </tr>
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.Id_Etapa_Procesal)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Id_SubEtapa_Procesal)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Id_Accion)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.id_AccionProcesal)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Descripcion)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Usu_Act)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.Fecha_Act)
                            </th>
                            <th></th>
                        </tr>
                    </thead>
                         <tbody>
                    @foreach (var item in Model) {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.Id_Etapa_Procesal)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Id_SubEtapa_Procesal)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Id_Accion)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.id_AccionProcesal)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Descripcion)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Usu_Act)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Fecha_Act)
                            </td>
                            <td>
                                @Html.ActionLink("Edit", "Editar", new {Id_Accion = item.id_AccionProcesal}, new{@class = "ajax"}) |
                                @Html.ActionLink("Details", "DetallesAccion", new { Id_Accion = item.id_AccionProcesal}, new{@class = "ajax"}) |
                                @Html.ActionLink("Delete", "EliminarAccion", new { Id_Accion = item.id_AccionProcesal}, new{@class ="eliminarAccion"})
                            </td>
                        </tr>
                    }
                    </tbody>
                            <tfoot>
                               
                            </tfoot>
                    </table> 
    </div>
   
@section scripts {
    <link href="~/Content/colorbox/colorbox.css" rel="stylesheet" />
    <script src="~/Scripts/jquery.colorbox-min.js"></script>
    <link href="~/Content/css/jquery.dataTables.css" rel="stylesheet" />
    <script src="~/Content/js/jquery.dataTables.js"></script>
    <script type="text/javascript">
 
        $(document).ready(function () {

            ConstruirTabla();

            function ConstruirTabla() {
                var table;
                var asInitVals = new Array();
                table = $("#tableOne").dataTable({
                    "sPaginationType": "full_numbers",
                    "iDisplayLength": 5,
                    "aLengthMenu": [[5, 10, 15, 20, 25, 50, 100, -1], [5, 10, 15, 20, 25, 50, 100, "Todos"]]
                });
            }
            
        });
        $(".ajax").colorbox();
        $(".ajax").colorbox().resize({ width: 700,height:700 });;
        $('.eliminarAccion').live('click', function (e) {
            e.preventDefault();
            if (confirm("¿Estás seguro de eliminar esta acción?")) {
                var url = $(this).attr('href');
                $.ajax({
                    type: 'GET',
                    url: url,
                    success: function (data) {
                        if (data.Exito == true) {
                            alert("Acción eliminada con éxito");
                            window.open("/Acciones/ListaAcciones", "_self");
                        }else
                            alert("Error al eliminar la acción");
                    }, error: function (data) {
                        alert("No se puede eliminar la acción");
                    }
                });
            } else
                return false;
        });
    </script>        
}
